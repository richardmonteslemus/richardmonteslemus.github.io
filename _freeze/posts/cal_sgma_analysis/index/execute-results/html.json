{
  "hash": "b2d252168ebfb72be21b09ff95f89b6e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Evaluating California's Sustainable Groundwater Management Act\"\ndescription: \"Using segmented regression to analyze groundwater level trends before and after SGMA implementation\"\nauthor: \"Richard Montes Lemus\"\ndate: \"2025-12-12\"\ncategories: [water resources, policy analysis, R, regression]\nimage: \"groundwater.png\"\ndraft: false\n\nformat:\n  html:\n    code-fold: true\n---\n\n[Link to Github Repository](https://github.com/richardmonteslemus/Cal_SGMA) This repository contains code, file structures, and references for the following California Sustainable Groundwater Management Act analysis.\n\n# About\n\nIn 2014, California passed the Sustainable Groundwater Management Act (SGMA) aimed at addressing the over-exploitation of groundwater across California (Water Education Foundation, n.d.). The need for groundwater regulation was made urgent by the severe California drought of 2012-2016. This act required local and regional agencies to develop and implement sustainable groundwater management plans. High and medium-priority basins in critical overdraft were required to submit and begin implementing management plans by January 2020, while the rest had until January 2022 (Water Education Foundation, n.d.).\n\nThis analysis uses a segmented regression model to evaluate whether groundwater level trends changed significantly from January 2012 through November 2025 for monitoring wells across California operated by the California Department of Water Resources. The associated breakpoint estimate from this model will hint at whether it was due to the SGMA implementation of 2020 or something else.\n\n# Hypothesis\n\n**Null Hypothesis (H₀):** The slope of groundwater levels over time does not change before and after a breakpoint.\n\n$$H_0: \\beta_2 = 0$$\n\n**Alternative Hypothesis (Hₐ):** The slope of groundwater levels over time changes before and after a breakpoint.\n\n$$H_a: \\beta_2 \\neq 0$$\n\n$\\beta_2$ represents the change in slope after the breakpoint. If $H_0$ is true, a single linear trend describes the entire time series. If $H_a$ is true, two different slopes are needed.\n\n# Data limitation\n\nThe groundwater level data used in this analysis exhibits several features that affect the statistical analysis:\n\nSeasonality: Groundwater levels fluctuate seasonally, increasing during wet seasons and decreasing during dry periods. This could make it difficult to distinguish seasonal groundwater water depletion from over drafting.\n\nAutocorrelation not addressed: This analysis does not account for autocorrelation in the regression model. Groundwater levels depend on previous levels. This creates autocorrelation for our response variables. Therefore, groundwater level observations cannot be considered independent. This can affect the reliability of standard errors and significance tests.\n\nPolicy Intervention Variation: Not all wells were subject to the January 2020 SGMA Sustainable Groundwater Plan submission and implementation. Some wells had until January 2022 to start implementing their plan. Despite this, a single policy intervention date (January 2020) was used in order to make a single breakpoint for groundwater level observations over time.\n\n# DAG\nThis directed acyclic graph (DAG) visualizes the different causal relationships influencing groundwater levels. \n\n![Directed Acyclic Graph](dag.png){width=80% fig-align=\"center\"}\n\n1. **Seasonality → Precipitation:** Season influences when California experiences different precipitation intensities - which replenish groundwater (i.e. wet winters vs. dry summers).\n\n2. **Seasonality → Groundwater Level:** Seasonal cycles directly affect groundwater levels due to different seasons having different evapotranspiration and precipitation patterns. \n\n3. **Precipitation → Groundwater Level:** Rainfall and snowmelt are the primary contributors to groundwater recharge.\n\n4. **Time → SGMA Implementation:** The policy was implemented at a specific point \n   in time (January 2020 for priority basins).\n\n5. **SGMA Implementation → Groundwater Level:** This policy directly impacted groundwater pumping, withdrawal restrictions and recharge projects. Therefore it is expected to affect groundwater levels.\n\n\n# References\n\nCalifornia Department of Water Resources. (November 1, 2025). Continuous Groundwater Level Measurements. California Natural Resources Agency Open Data Portal. Retrieved December 4, 2024, from https://data.cnra.ca.gov/dataset/continuous-groundwater-level-measurements\n\nCalifornia Department of Water Resources. (November 1, 2025). Groundwater Sustainability Agencies. Retrieved December 4, 2024, from https://water.ca.gov/Programs/Groundwater-Management/SGMA-Groundwater-Management/Groundwater-Sustainable-Agencies\n\nPurohit, S. (2025). Rainfall in California: Special Reference to 2023 Rains That Caused Floods. Annals of the American Association of Geographers, 115(1), 97–109. https://doi.org/10.1080/24694452.2024.2400078\n\nWater Education Foundation. (n.d.). Sustainable Groundwater Management Act (SGMA). Aquapedia. Retrieved December 4, 2024, from https://www.watereducation.org/aquapedia-background/sustainable-groundwater-management-act-sgma\n\n# Read in and clean data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load in libraries\nlibrary(segmented)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(lubridate)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(broom)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in groundwater level data \ngw_level_month <- read_csv(here(\"posts\", \"cal_sgma_analysis\", \"data\", \"16f256f8-35a4-4cab-ae02-399a2914c282.csv\"))\n\n# Read in groundwater station metadata\nstation <- read_csv((here(\"posts\", \"cal_sgma_analysis\", \"data\", \"03967113-1556-4100-af2c-b16a4d41b9d0.csv\")))\n```\n:::\n\n\nThe following code is used to generate a final data frame with information about each well's water surface elevation and station metadata. It transforms the time column from a string type to a date type to facilitate exploratory analysis plotting. Lastly, it removes problematic well measurements based on quality codes. It only keeps rows with quality codes 1 (good data), 2 (Good quality edited data), 10 (Good measurement), 15 (Provisional measurement).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Join station and water level data \nstation_gw <- left_join(gw_level_month, station, by = \"STATION\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Turn time column into datetime type\nstation_gw <- station_gw %>% \n  mutate (\"MSMT_DATE\" = ymd(station_gw$MSMT_DATE)) %>% \n  filter(MSMT_DATE >= ymd(\"2012-01-01\")) # Select  measurements from 2012 and on \n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Final quality filtering\nquality_codes_to_keep <- c(1, 2, 10, 15)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Return dataframe with high quality groundwater level measurements\nstation_gw_filtered <- station_gw %>%\n  filter(WSE_QC %in% quality_codes_to_keep) %>%\n  filter(!is.na(WSE))  # Remove missing water surface elevations\n```\n:::\n\n\n# Prepare data for segmented regression model\n\nThe following code calculates the monthly mean groundwater level across all wells and creates a time counter variable, a variable needed for the segmentation regression analysis. The counter starts at 0 for January 2012 and increases by 1 for each following month. The code also obtains the counter number for January 2020 (SGMA implementation), which will be used as an initial estimate for the breakpoint in the segmented regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate monthly average across all wells\nstation_month_avg <- station_gw_filtered %>%\n  group_by(MSMT_DATE) %>%\n  summarize(mean_WSE = mean(WSE, na.rm = TRUE),\n            n_wells = n()) %>%\n  ungroup() %>% \n  arrange(MSMT_DATE) %>% # arrange by date \n  mutate(Time = 0:(n()-1)) # Add monthly counter \n\n# Find monthly counter number for policy implementation date\njan_2020_time <- min(station_month_avg$Time[station_month_avg$MSMT_DATE >= ymd(\"2020-01-01\")])\n```\n:::\n\n\n# Explore Observed Data\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create plot for observed data\nggplot(station_month_avg, aes(x = MSMT_DATE, y = mean_WSE)) +\n  # Add shaded regions for drought\n  annotate(\"rect\", \n           xmin = ymd(\"2012-01-01\"), xmax = ymd(\"2016-12-31\"),\n           ymin = -Inf, ymax = Inf,\n           fill = \"salmon\", alpha = 0.1) +\n  annotate(\"text\", x = ymd(\"2014-06-01\"), y = min(station_month_avg$mean_WSE),\n           label = \"California Drought\", size = 3, color = \"darkred\", fontface = \"italic\") +\n  \n  # Plot data\n  geom_line(color = \"cornflowerblue\", size = 1) +\n  geom_point(size = 1.5, alpha = 0.6, color = \"cornflowerblue\") +\n  \n  # Add SGMA vertical line\n  geom_vline(xintercept = ymd(\"2020-01-01\"), \n             linetype = \"dashed\", color = \"darkgreen\", size = 0.8) +\n  \n  annotate(\"text\", x = ymd(\"2020-01-01\"), y = max(station_month_avg$mean_WSE) * 0.95,\n           label = \"SGMA\\nImplementation\", color = \"darkgreen\", hjust = -0.1, size = 3.5) +\n  \n  labs(\n    title = \"Monthly Average Groundwater Levels in California (2012-2025)\",\n    x = \"Date\",\n    y = \"Mean Water Surface Elevation (feet)\",\n    caption = \"Monthly averages across all California DWR monitoring wells\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 13, face = \"bold\"),\n    axis.title = element_text(size = 11)\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n# Create and Simulate Segmentation Regression Model\n\nThe statistical notation for this segmentation regression model is as follows:\n\n$$\n\\text{WSE} \\sim \\text{Normal}(\\mu, \\sigma)\n$$\n\n$$\n\\mu = \\beta_0 + \\beta_1 \\cdot \\text{Time} + \\beta_2 \\cdot (\\text{Time} - \\psi) \\cdot I(\\text{Time} > \\psi)\n$$\n\nwhere:\n\n$$\nI(\\text{Time} \\gt \\psi) = \n\\begin{cases} \n0 & \\text{if } \\text{Time} \\leq \\psi \\\\\n1 & \\text{if } \\text{Time} > \\psi\n\\end{cases}\n$$\n\n### Model explanation:\n\nThis analysis uses a segmented linear model to test whether groundwater level trends changed significantly from January 2012 - November 2025. The model assumes that the relationship between time and water surface elevation (WSE) follows two different linear trends separated by a breakpoint (ψ).\n\nBefore the breakpoint, groundwater levels change at one rate (β₁). After the breakpoint, the rate of change shifts to a new slope (β₁ + β₂). The model estimates when this breakpoint occurs and whether the change in slope is statistically significant.\n\n**Parameters:**\n\n-   **WSE:** Observed water surface elevation (feet above sea level) for a month.\n\n-   **μ:** Expected (mean) water surface elevation for a month.\n\n-   **β₀**: Intercept, water surface elevation at Time = 0 (January 2012).\n\n-   **β₁**: Pre-breakpoint slope, rate of change in groundwater levels before the breakpoint (feet per month).\n\n-   **β₂**: Change in slope, additive rate of change after the breakpoint (feet per month).\n\n-   **Time**: Months since January 2012 (Time = 0 for January 2012, Time = 1 for February 2012, etc.)\n\n-   **ψ** (psi): Breakpoint, the month when the trend changes (estimated from data).\n\n-   **(Time - ψ)**: Represents the \"distance\" past the breakpoint. If 96 is **ψ**, at 96 it is 0 and at 97 is it 1.\n\n-   **σ** (sigma): standard deviation, variation around the regression line\n\n-   **I()**: Indicator function, equals 1 when the time is greater than **ψ,** causing the slope to be (β₁ + β₂). Equals 0 If time is less than or equal to **ψ**, causing the slope to be (β₁).\n\n### Simulate Data\n\nBefore applying the segmentation regression to real groundwater data, we should ensure the model can correctly identify the breakpoints and slopes of our simulated data with known parameters.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create simulation consistent\nset.seed(123)\n\n# Known parameters\nbeta0_true <- 250\nbeta1_true <- 0.5\nbeta2_true <- 10\npsi_true <- 100\nsigma_true <- 30\n \n# Create time series ranging from 0 - 150\nTime <- seq(0,150)\n\n# Create the (Time - ψ) term\n# Set values to 0 before ψ\nafter <- pmax(0, Time - psi_true)\n\n# Create true mean\nmu_true <- beta0_true + beta1_true * Time + beta2_true * after\n\n# Create random noise given standard deviation\nWSE_sim <- rnorm(length(Time), mean = mu_true, sd = sigma_true)\n\n# Create table\nsim_data <- tibble(Time, WSE_sim)\n```\n:::\n\n\n### Test Parameter Recovery\n\nTest if our segmentation regression model can recover the true parameters we intially set. If successful we can apply the model to our real data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit model to simulated data\n\n# A linear model is a prerequisite to using the segmentation model\ninitial_sim <- lm(WSE_sim ~ Time, data = sim_data)\n\n# Fit to segmentation model\nseg_sim <- segmented(initial_sim, seg.Z = ~Time, psi = 90) # Set initial ψ guess to 90 \n\n# Compare estimated parameters to true parameters\ncomparison <- tibble(\n  Parameter = c(\"β₀ (Intercept)\", \"β₁ (Pre-slope)\", \"β₂ (Slope change)\", \"ψ (Breakpoint)\"),\n  True_Value = c(beta0_true, beta1_true, beta2_true, psi_true),\n  Estimated = c(coef(seg_sim)[1], coef(seg_sim)[2], coef(seg_sim)[3], seg_sim$psi[2])\n)\n\nkable(comparison, digits = 2, caption = \"Parameter Recovery Test\")\n```\n\n::: {.cell-output-display}\n\n\nTable: Parameter Recovery Test\n\n|Parameter         | True_Value| Estimated|\n|:-----------------|----------:|---------:|\n|β₀ (Intercept)    |      250.0|    249.29|\n|β₁ (Pre-slope)    |        0.5|      0.57|\n|β₂ (Slope change) |       10.0|     10.06|\n|ψ (Breakpoint)    |      100.0|    101.62|\n\n\n:::\n:::\n\n\n### Parameter Recovery Results\n\nThe model successfully recovered the known parameters. The breakpoint and intercept estimate were only 1 value away from the true value. β₁ and β₂ were only 0.01 and 0.1 values away respectively.This successful validation means we can confidently apply this model to our real groundwater data.\n\n# Fit Segmentation Model to Observed Groundwater Data\n\nUse real groundwater data to find the breakpoint and the slope before and after the breakpoint.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit prerequisite linear model\ninitial_model <- lm(mean_WSE ~ Time, data = station_month_avg)\n\n# Fit segmented regression\nsgma_segmented <- segmented(initial_model, \n                            seg.Z = ~Time,\n                            psi = jan_2020_time)\n# Create clean table with summary ouputs\ntidy(sgma_segmented) %>%\n  mutate(\n    term = case_when(\n      term == \"(Intercept)\" ~ \"Intercept (β₀)\",\n      term == \"Time\" ~ \"Pre-breakpoint slope (β₁)\",\n      term == \"U1.Time\" ~ \"Slope change (β₂)\",\n      term == \"psi1.Time\" ~ \"Breakpoint (ψ)\",  \n      TRUE ~ term\n    ),\n    p.value = c(\"< 0.001\", \"0.0101\", \"< 0.001\", \"—\")  \n  ) %>%\n  kable(digits = 3,\n        col.names = c(\"Parameter\", \"Estimate\", \"Std. Error\", \"t-statistic\", \"p-value\"),\n        caption = \"Segmented Regression Model Coefficients\",\n        align = c(\"l\", \"r\", \"r\", \"r\", \"c\")) %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = FALSE) %>%\n  footnote(general = \"Post-breakpoint slope = β₁ + β₂ = 12.03 feet/month\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;\">\n<caption>Segmented Regression Model Coefficients</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Parameter </th>\n   <th style=\"text-align:right;\"> Estimate </th>\n   <th style=\"text-align:right;\"> Std. Error </th>\n   <th style=\"text-align:right;\"> t-statistic </th>\n   <th style=\"text-align:center;\"> p-value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Intercept (β₀) </td>\n   <td style=\"text-align:right;\"> 249.294 </td>\n   <td style=\"text-align:right;\"> 8.745 </td>\n   <td style=\"text-align:right;\"> 28.507 </td>\n   <td style=\"text-align:center;\"> &lt; 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Pre-breakpoint slope (β₁) </td>\n   <td style=\"text-align:right;\"> 0.312 </td>\n   <td style=\"text-align:right;\"> 0.120 </td>\n   <td style=\"text-align:right;\"> 2.602 </td>\n   <td style=\"text-align:center;\"> 0.0101 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Slope change (β₂) </td>\n   <td style=\"text-align:right;\"> 11.720 </td>\n   <td style=\"text-align:right;\"> 0.715 </td>\n   <td style=\"text-align:right;\"> 16.384 </td>\n   <td style=\"text-align:center;\"> &lt; 0.001 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Breakpoint (ψ) </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:right;\"> 1.534 </td>\n   <td style=\"text-align:right;\"> 0.000 </td>\n   <td style=\"text-align:center;\"> — </td>\n  </tr>\n</tbody>\n<tfoot>\n<tr><td style=\"padding: 0; \" colspan=\"100%\"><span style=\"font-style: italic;\">Note: </span></td></tr>\n<tr><td style=\"padding: 0; \" colspan=\"100%\">\n<sup></sup> Post-breakpoint slope = β₁ + β₂ = 12.03 feet/month</td></tr>\n</tfoot>\n</table>\n\n`````\n:::\n:::\n\n\n### Coefficients Interpretation\n\nThe segmented regression identified the following relationships between time and groundwater levels:\n\n**Intercept (β₀):** 249.29 feet (SE = 8.75, p \\< 0.001)\\\nThe baseline water surface elevation in January 2012 (Time = 0) was around 249 feet above sea level.\n\n**Pre-breakpoint slope (β₁):** 0.31 feet/month (SE = 0.12, p = 0.010)\\\nBefore the breakpoint, groundwater levels increased by approximately 0.31 feet per month on average. This positive slope is likely due to recovery from the severe 2012-2016 California drought, which had depleted groundwater. Since the 95% confidence interval \\[0.07, 0.55\\] feet/month does not include zero, we are confident there is a statistically significant positive slope during this period.\n\n**Slope change (β₂):** 11.72 feet/month (SE = 0.72, t = 16.38, p \\< 0.001)\\\nAfter the breakpoint, the slope increased by 11.72 feet per month. The extremely large t-statistic (16.38) indicates this change is highly statistically significant, despite the p-value initially displaying as NA in the output for the summary() function.\n\n**Post-breakpoint slope (β₁ + β₂):** 12.03 feet/month\\\nAdding together the pre-breakpoint slope (0.31) and the slope change (11.72) caused the rate of groundwater level increase after the breakpoint to become 12.03 feet per month. This represents a very large increase compared to the pre-breakpoint rate.\n\n### Breakpoint Confidence Interval and Interpretation\n\nEstimate the confidence interval for the breakpoint output by the segmentation regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get confidence intervals for all parameters \nseg_ci <- confint(sgma_segmented)\n\n# Convert to data frame\nci_table <- as.data.frame(seg_ci)\nci_table$Parameter <- rownames(ci_table)\n\n# Name columns\ncolnames(ci_table) <- c(\"Estimate\", \"Lower_CI\", \"Upper_CI\", \"Parameter\")\n\n# Reorder columns\nci_table <- ci_table[, c(\"Parameter\", \"Estimate\", \"Lower_CI\", \"Upper_CI\")]\n\n# Make table\nci_table <- ci_table %>%\n  mutate(across(c(Estimate, Lower_CI, Upper_CI), ~round(., 2)))\n\nci_table %>%\n  kable(caption = \"Segmented Model 95% Confidence Intervals\", \n        align = \"c\",\n        col.names = c(\"Parameter\", \"Estimate\", \"Lower (95% CI)\", \"Upper (95% CI)\")) %>%\n  kable_styling(bootstrap_options = \"striped\", full_width = FALSE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Segmented Model 95% Confidence Intervals</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:center;\"> Parameter </th>\n   <th style=\"text-align:center;\"> Estimate </th>\n   <th style=\"text-align:center;\"> Lower (95% CI) </th>\n   <th style=\"text-align:center;\"> Upper (95% CI) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> psi1.Time </td>\n   <td style=\"text-align:center;\"> psi1.Time </td>\n   <td style=\"text-align:center;\"> 126.86 </td>\n   <td style=\"text-align:center;\"> 123.83 </td>\n   <td style=\"text-align:center;\"> 129.89 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe model estimated the breakpoint at **month 126.86** (approximately **September 2022**), with a 95% confidence interval from month 124 to 130 (**July–November 2022**).\n\nThis breakpoint does not align with SGMA implementation in January 2020 (month 96). The confidence interval does not include month 96 which suggests something else caused this change in groundwater level trends.\n\n### Model Fit:\n\n**R\\^2 = 0.8648:** This model explains about 86.7% of the variability in groundwater levels during selected dates. This indicated a strong model fit.\n\n# Generate predicitons\n\nCreate a grid of predictions to input into model with confidence intervals.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create grid of predictions for entire time range \npred_grid <- expand_grid(\n  Time = seq(0, max(station_month_avg$Time), by = 1) # Have every month from 0 to end \n)\n\n# Generate predictions with standard errors\nseg_predictions_se <- predict(sgma_segmented, \n                              newdata = pred_grid, \n                              se.fit = TRUE)\n\n# Generate predictions and confidence intervals\nsegmented_predictions <- pred_grid %>%\n  mutate(\n    # Predictions and uncertainty\n    predicted_WSE = seg_predictions_se$fit,\n    se = seg_predictions_se$se.fit,\n    ci_lower = predicted_WSE - qnorm(0.975) * se,  # 95% CI\n    ci_upper = predicted_WSE + qnorm(0.975) * se,\n    \n    # Add date labels\n    MSMT_DATE = min(station_month_avg$MSMT_DATE) + months(Time),\n    period = ifelse(Time < sgma_segmented$psi[2], \"Pre-breakpoint\", \"Post-breakpoint\")\n  )\n\n# Assign predicted breakpoint \nbreakpoint_date <- ymd(\"2022-09-01\")\n```\n:::\n\n\n# Plot predictions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot observed data and predicted segmented regression lines\nggplot() +\n  # Plot confidence intervals\n  geom_ribbon(data = segmented_predictions,\n              aes(x = MSMT_DATE, ymin = ci_lower, ymax = ci_upper, fill = period),\n              alpha = 0.2) +\n  \n  # Plot observed data\n  geom_point(data = station_month_avg, \n             aes(x = MSMT_DATE, y = mean_WSE),\n             alpha = 0.5, size = 2, color = \"gray40\") +\n  \n  # Plot predicted lines\n  geom_line(data = segmented_predictions,\n            aes(x = MSMT_DATE, y = predicted_WSE, color = period)) +\n  \n  # Add vertical lines to indicate breakpoints\n  geom_vline(xintercept = breakpoint_date,\n             linetype = \"dashed\", color = \"red\", size = 1) +\n  geom_vline(xintercept = ymd(\"2020-01-01\"),\n             linetype = \"dotted\", color = \"darkgreen\", size = 1) +\n  \n  annotate(\"text\", x = breakpoint_date, y = 750,\n           label = \"Model-estimated\\nbreakpoint\\n(Sept 2022)\",\n           color = \"red\", hjust = -0.1, size = 2) +\n  annotate(\"text\", x = ymd(\"2020-01-01\"), y = 200,\n           label = \"SGMA\\nimplementation\\n(Jan 2020)\",\n           color = \"darkgreen\", hjust = 1.1, size = 2) +\n  \n  scale_color_manual(values = c(\"Pre-breakpoint\" = \"cornflowerblue\", \n                                 \"Post-breakpoint\" = \"firebrick\"),\n                     name = \"Time Period\") +\n  scale_fill_manual(values = c(\"Pre-breakpoint\" = \"cornflowerblue\", \n                                \"Post-breakpoint\" = \"firebrick\"),\n                    name = \"Time Period\") +\n  \n  labs(\n    title = \"Segmented Regression: Groundwater Levels with 95% Confidence Intervals\",\n    x = \"Date\",\n    y = \"Mean Water Surface Elevation (feet)\",\n    caption = \"Shaded ribbons show 95% confidence intervals around predictions\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 11, face = \"bold\"),\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n# Conclusion\n\n## Hypothesis Test Results\n\n### Slope Change (β₂) Significance\n\nThe estimated slope change was **11.72 ± 0.72 feet/month** with a highly significant p value of \\< 0.001. We therefore reject the null hypothesis and conclude that the slope of groundwater levels changed significantly during the study period.\n\n## Breakpoint analysis\n\nThe breakpoint for this segmentation model was estimated to be at month 126.86, which corresponds to September 2022. We are 95% confident this breakpoint falls between month 124 and 130 (July-November 2022). This breakpoint does not align with SGMA implementation in January 2020 (month 96). The confidence interval does not include month 96 which suggests something else caused this change in groundwater level trends.\n\nThis breakpoint, however, does align with extreme precipitation events that occured during this time. Around September 2022, California experienced record-breaking rainfall in several regions (Purohit, 2025). This replenished groundwater levels all over the state. Despite this timing strongly suggesting the extreme precipitation event caused this change in groundwater level slope, we cannot attribute the entire trend change to weather. We would need to account for seasonality and precipitation in addition to time for our model. We would also need to compare these water levels to a control group that did not experience this SGMA implementation in order to isolate the changes in groundwater level trends due to weather event and the SGMA implementation.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}